from flask import request
from entity.user import User
from dao.userdao import UserDAO
import re
from .md5_fun import md5



#获取前端传过来的注册用的账户名和两次密码
#对密码进行判断一致性判断
#注册用的密码必须是6位以上而且必须包括四部分：数字、小写字母、大写字母、特殊字符
userDAO = UserDAO()
def Register_judge():
    userName = request.form['username']
    userPwd  = request.form['password']
    reUserPwd = request.form['reuserpwd']
    regiest = re.compile(r'^.*(?=.{6,})(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&*? ]).*$')
    if userPwd == reUserPwd and userName != "":
        if regiest.search(userPwd):
            user = User()
            user.userName = userName
            userPwd = md5(userPwd)
            user.userPwd  = userPwd
            result = userDAO.createUser(user)
            return result